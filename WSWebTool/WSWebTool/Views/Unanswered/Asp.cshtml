@model PagedList.IPagedList<WSWebTool.Models.UnansweredThreads>
@using PagedList.Mvc;

@{
    ViewBag.Title = "ASP.NET";
    List<string> productlist = ViewBag.productlist;
}

<h2>Unanswered</h2>



@using (Html.BeginForm("Asp", "Unanswered", FormMethod.Get))
{
    <p>
        Find by Product:
        @Html.DropDownList("Product", new SelectList(productlist), "-- Click to Select --")
        <input type="submit" value="Search" />
    </p>
}





@*Today is @DateTime.Now.ToShortDateString() &nbsp; @ViewBag.CProduct  &nbsp;Threads: @ViewBag.Threads   &nbsp;Marked: @ViewBag.Marked  &nbsp; @ViewBag.Need*@
<table class="table">
    <tr>
        <th width="500px">
            Title
        </th>

        <th width="200px" style="text-align:center">
            Idle Time
        </th>
        <th>

        </th>
        <th>
            Product
        </th>

        <th>

        </th>
        <th>

        </th>
        <th>

        </th>
    </tr>

    @foreach (var item in Model)
    {

        <tr>
            <td width="500px">
                <a href=@item.url target="_blank" style="overflow: hidden; text-overflow: ellipsis">@item.title</a>
            </td>

            <td  style="text-align:center">
                @item.Idle
            </td>
            <td></td>
            <td>
                @Html.DisplayFor(modelItem => item.Product)
            </td>

            <td></td>
            <td style="text-align:center; vertical-align:middle;">


                @using (Html.BeginForm("Detail", "Unanswered"))
                {
                    <input type="hidden" name="thread" value="@item" />
                    <input type="submit" value="Detail" class="form-control" />
                }

                @*<input id="@item.ThreadId" type="button" value="Update" class="form-control"/>*@
            </td>
            <td></td>
        </tr>

    }

</table>


            Page @(Model.PageCount < Model.PageNumber ? 0 : Model.PageNumber) of @Model.PageCount

            @Html.PagedListPager(Model, page => Url.Action("Asp", new { page, product = ViewBag.product }))

            @section scripts {
                <link href="~/Content/PagedList.css" rel="stylesheet" type="text/css" />
                <script src="~/Scripts/bootstrap-notify.min.js"></script>
                <script>

                    function addNote(x) {
                        $(x).parent().find("textarea").attr("disabled", "disabled");
                        var serviceURL = '/Unanswered/AddNote';
                        var Note = $(x).parent().parent().find("textarea").val();
                        var Id = $(x).attr('id');
                        $.ajax({
                            type: "POST",
                            url: serviceURL,
                            data: JSON.stringify({
                                Note: Note,
                                Id: Id
                            }),
                            contentType: "application/json; charset=utf-8",
                            dataType: "json",
                            success: function (response) {
                                $(x).parent().find("textarea").removeAttr("disabled");
                                note();
                            },
                        });
                    }



                    function note() {
                        $.notify({
                            title: "<strong>Sucess:</strong> ",
                            message: "The Note is updated"
                        });
                    }
                </script>
            }
